# Клон игры Frogger (1981)

---

## 1. Введение

Данный проект представляет собой реализацию 2D-аркадной игры, основанной на классической игре "Frogger" (1981).

Проект полностью реализован на языке **Python** с использованием библиотеки **OpenCV** для рендеринга.

## 2. Концепция оригинальной игры

Оригинальная игра "Frogger" ставит перед игроком задачу провести лягушку из нижней части экрана (стартовая зона) в один из пяти "домов" в верхней части. Путь преграждают две основные зоны:

1.  **Дорога:** Несколько полос с интенсивным движением, где машины, грузовики и автобусы движутся горизонтально с разными скоростями.
2.  **Река:** Несколько полос, по которым плывут бревна и крокодилы.

Игрок должен избегать столкновений с транспортом и не упасть в воду. Пересечь реку можно, прыгая по бревнам и, в некоторых версиях, по спинам крокодилов.

## 3. Реализованный функционал

Данная реализация включает в себя следующий основной функционал:

* **Игровой мир:** Игровое поле разделено на сетку (17x12 ячеек). Присутствуют все ключевые зоны: стартовая "трава", дорога, река и финишная зона.
* **Игрок (Лягушка):**
    * Управляется игроком (вверх, вниз, влево, вправо).
    * Спрайт лягушки меняет направление "взгляда" в зависимости от последнего движения.
* **Дорога:**
    * Реализовано 4 полосы движения (`ROAD_LANES` в `settings.py`).
    * Объекты `Car` спавнятся за пределами экрана и движутся с заданной скоростью и направлением.
    * Столкновение с машиной приводит к потере жизни.
* **Река:**
    * Реализовано 4 полосы движения (`WATER_LANES` в `settings.py`).
    * Спавнятся два типа объектов: `WoodLog` (бревно) и `Crocodile` (крокодил).
    * **Логика воды:**
        * Падение в воду (промах мимо объекта) приводит к потере жизни.
        * Столкновение с крокодилом приводит к потере жизни.
        * Приземление на бревно "прикрепляет" (`attach_to`) лягушку к нему. Лягушка начинает двигаться вместе с бревном.
        * Если лягушку на бревне уносит за пределы экрана, она теряет жизнь.
* **Система спавна:**
    * Модуль `spawners.py` управляет появлением объектов.
    * `CarSpawner` и `WaterLaneSpawner` генерируют объекты на своих полосах, учитывая интервалы, скорости и вероятности появления объектов разного размера.
    * Реализованы механики для избежания спавна объектов "внутри" друг друга (`_can_spawn_in_lane`).
* **Игровой цикл:**
    * Реализованы состояния игры: `START` (начальный экран), `PLAYING` (игра), `PAUSED` (пауза), `GAME_OVER` (конец игры) и `WIN` (победа).
    * Игрок начинает с 3 жизнями (`START_LIVES`).
    * Достижение финишной зоны (`FINISH_ROWS`) засчитывает победу (`_check_win`).
* **Графика:**
    * Вся графика процедурно генерируется в `rendering.py` при запуске игры (`load_assets`).
    * Фон, трава и кувшинки отрисовываются функциями `cv2.rectangle`, `cv2.line`, `cv2.circle`.
    * Спрайты (лягушка, машины, бревна, крокодилы) создаются как 4-канальные (BGRA) `numpy` массивы.
    * Для отрисовки спрайтов с прозрачностью используется кастомная функция `overlay_sprite`.

## 4. Инструкция к игре

### Цель

Провести лягушку со стартовой зеленой зоны внизу экрана до финишной зоны с кувшинками вверху экрана, избегая препятствий.

### Управление

* **Начало игры:** `Enter` (находясь на стартовом экране)
* **Движение:**
    * `W` или `Стрелка Вверх`: Прыжок вверх
    * `S` или `Стрелка Вниз`: Прыжок вниз
    * `A` или `Стрелка Влево`: Прыжок влево
    * `D` или `Стрелка Вправо`: Прыжок вправо
* **Пауза:** `P` (поставить/снять паузу)
* **Выход:** `Q` или `ESC`

### Правила

1.  У вас есть 3 жизни.
2.  Столкновение с машиной на дороге отнимает жизнь.
3.  Падение в воду отнимает жизнь.
4.  Пересекать реку можно только прыгая по бревнам.
5.  Столкновение с крокодилом отнимает жизнь.
6.  Если лягушку унесет за край экрана (пока она на бревне), это отнимает жизнь.
7.  При потере жизни лягушка возвращается на исходную позицию.
8.  При потере всех жизней игра заканчивается (`GAME OVER`).
9.  При достижении финишной зоны вам засчитывается победа (`YOU WIN`).

## 5. Техническая реализация

### 5.1. Основные технологии

* **Python 3.x**
* **OpenCV** (`opencv-python`): Используется как для создания окна и обработки ввода, так и для рендеринга всей графики.
* **NumPy:** Используется библиотекой OpenCV для операций с массивами (кадрами и спрайтами).

### 5.2. Реализация графики

Вместо использования растровых изображений (например, `.png`), данный проект использует только примитивы OpenCV.

1.  **Генерация ассетов:** При запуске игры (`main.py`) вызывается функция `load_assets()` из `rendering.py`.
2.  Эта функция процедурно генерирует спрайты для каждого объекта:
    * `_create_frog_sprite()`: Рисует лягушку с "глазами", указывающими направление.
    * `_create_car_sprite()`: Рисует машины разных цветов и размеров, с "фарами" и "стеклом".
    * `_create_log_sprite()`: Рисует бревно с "линиями коры".
    * `_create_croc_sprite()`: Рисует крокодила с "глазами".
3.  **Альфа-канал:** Каждый спрайт создается как 4-канальный `numpy` массив (BGR + **Alpha**). Альфа-канал (прозрачность) используется для создания непрямоугольных форм (например, пустое пространство вокруг лягушки в ее 40х40 пиксельной ячейке).
4.  **Рендеринг:** Во время игрового цикла функция `draw_movers()` и `draw_frog()` не рисуют простые прямоугольники, а вызывают `overlay_sprite()`. Эта функция реализует альфа-смешивание ("alpha blending"), корректно накладывая полупрозрачный спрайт на фон.

Таким образом, вместо загрузки готовых картинок, мы создаем их процедурно в коде.

### 5.3. Структура проекта

* `main.py`: Точка входа. Инициализирует ассеты и запускает игровой цикл.
* `game.py`: Основной класс `Game`. Управляет состояниями игры, вводом, циклом `update/draw` и проверкой правил (коллизии, победа, поражение).
* `entities.py`: Определяет классы данных для `Frog`, `Car`, `WoodLog`, `Crocodile`. Описывает их состояние, логику движения и хитбоксы.
* `spawners.py`: Управляет логикой появления `Car` и объектов на воде (`WoodLog`, `Crocodile`). Отвечает за их начальную позицию, скорость и интервалы появления.
* `rendering.py`: Отвечает за всю отрисовку. Генерирует спрайты (`load_assets`), рисует фон (`draw_background`) и накладывает спрайты (`overlay_sprite`).
* `settings.py`: Файл конфигурации. Содержит все игровые константы (размеры, скорости, цвета, вероятности).
* `enums.py`: Содержит перечисления (`Enum`) для игровых состояний (`GameState`), направлений (`Direction`) и т.д.
* `utils.py`: Вспомогательные функции (например, `rects_intersect` для проверки коллизий).
